<UserControl x:Class="TournamentManager.Client.Views.BracketsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             x:Name="Root">
  <Grid Margin="16" Background="{StaticResource SecondaryBrush}">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <Border Grid.Row="0" Style="{StaticResource PanelStyle}" Padding="12">
      <TextBlock Text="Турнирные сетки" Style="{StaticResource HeaderTextStyle}"/>
    </Border>

    <Border Grid.Row="1" Style="{StaticResource CardStyle}" Padding="0">
      <TabControl>
        <TabControl.ItemContainerStyle>
          <Style TargetType="TabItem">
            <Setter Property="Header" Value="{Binding CategoryDisplay}"/>
          </Style>
        </TabControl.ItemContainerStyle>
        <TabControl.ContentTemplate>
          <DataTemplate>
            <ScrollViewer VerticalScrollBarVisibility="Auto">
              <StackPanel Margin="16">
                <ItemsControl ItemsSource="{Binding Matches}">
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <Border Margin="0,0,0,8" Padding="8" Background="{StaticResource WhiteBrush}" CornerRadius="4" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1">
                        <Grid>
                          <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                          </Grid.ColumnDefinitions>
                          <StackPanel>
                            <TextBlock Text="{Binding FirstParticipantName}" Style="{StaticResource BodyTextStyle}"/>
                            <TextBlock Text="{Binding SecondParticipantName}" Style="{StaticResource BodyTextStyle}"/>
                          </StackPanel>
                          <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBox Width="40" Margin="0,0,8,0" Text="{Binding FirstParticipantScore, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource TextBoxStyle}"/>
                            <TextBlock Text=":" Margin="0,0,8,0"/>
                            <TextBox Width="40" Margin="0,0,8,0" Text="{Binding SecondParticipantScore, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource TextBoxStyle}"/>
                            <Button Content="Сохранить"
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Command="{Binding DataContext.SaveMatchScoreCommand, ElementName=Root}"
                                    CommandParameter="{Binding}"/>
                          </StackPanel>
                        </Grid>
                      </Border>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </StackPanel>
            </ScrollViewer>
          </DataTemplate>
        </TabControl.ContentTemplate>
        <TabControl.ItemsSource>
          <Binding Path="DataContext.Brackets" RelativeSource="{RelativeSource AncestorType=UserControl}"/>
        </TabControl.ItemsSource>
      </TabControl>
    </Border>
  </Grid>
</UserControl>
